@page "/phayarsarDetails/{title}"
@inject HttpClient HttpClient

<PageTitle>Phayarsar</PageTitle>

@if (groupData == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <h3>@groupData.Title</h3>

    @if (groupData.Data == null || !groupData.Data.Any())
    {
        <p>No data available.</p>
    }
    else
    {
        <table class="table">
            <tbody>
                @foreach (var item in groupData.Data)
                {
                    <tr>
                        <td>@item.Title</td>
                    </tr>
                }
            </tbody>
        </table>
    }
}

@code {
    [Parameter]
    public string title { get; set; }

    private GroupData? groupData;

    public class GroupData
    {
        public int GroupId { get; set; }
        public string Title { get; set; }
        public List<DataItem> Data { get; set; }
    }

    public class DataItem
    {
        public int Id { get; set; }
        public int GroupId { get; set; }
        public string Title { get; set; }
        public string Content { get; set; }
    }

    protected override async Task OnParametersSetAsync()
    {
        try
        {
            var allGroups = await HttpClient.GetFromJsonAsync<GroupData[]>("data/data.json");
            if (allGroups != null)
            {
                groupData = allGroups.FirstOrDefault(g => g.Title == title);
            }
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Error fetching group data: {ex.Message}");
        }
    }
}
